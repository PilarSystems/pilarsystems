# ============================================
# PILAR SYSTEMS - Environment Variables
# ============================================
# Copy this file to .env.local and fill in all values
# NEVER commit .env.local or .env with real secrets!

# ============================================
# DATABASE
# ============================================
# PostgreSQL connection string
# Get from: Vercel Project Settings → Storage → Postgres → Connection String
# Or use local: postgresql://user:password@localhost:5432/pilarsystems
DATABASE_URL=postgresql://user:password@localhost:5432/pilarsystems

# ============================================
# SUPABASE AUTH
# ============================================
# Supabase project URL
# Get from: Supabase Dashboard → Project Settings → API → Project URL
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co

# Supabase anonymous key (public, safe for client-side)
# Get from: Supabase Dashboard → Project Settings → API → Project API keys → anon public
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

# Supabase service role key (secret, server-side only)
# Get from: Supabase Dashboard → Project Settings → API → Project API keys → service_role
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# ============================================
# STRIPE BILLING
# ============================================
# Stripe secret key (server-side only)
# Get from: Stripe Dashboard → Developers → API Keys → Secret key
# Use test key (sk_test_...) for development, live key (sk_live_...) for production
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key

# Stripe publishable key (public, safe for client-side)
# Get from: Stripe Dashboard → Developers → API Keys → Publishable key
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key

# Stripe webhook secret for signature verification
# Get from: Stripe Dashboard → Developers → Webhooks → Add endpoint → Signing secret
# Webhook URL: https://your-domain.com/api/stripe/webhooks
# Events to listen for: checkout.session.completed, invoice.payment_succeeded, 
#   customer.subscription.created, customer.subscription.updated, customer.subscription.deleted
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Stripe Price IDs (created by running: npx ts-node scripts/create-stripe-products.ts)
# PILAR BASIC: €100/month subscription
STRIPE_BASIC_PRICE_ID=price_basic_monthly

# PILAR BASIC: €500 one-time setup fee
STRIPE_BASIC_SETUP_FEE_ID=price_basic_setup

# PILAR PRO: €149/month subscription
STRIPE_PRO_PRICE_ID=price_pro_monthly

# PILAR PRO: €1000 one-time setup fee
STRIPE_PRO_SETUP_FEE_ID=price_pro_setup

# WhatsApp AI Add-on: €20/month
STRIPE_WHATSAPP_ADDON_PRICE_ID=price_whatsapp_addon

# ============================================
# OPENAI (AI AUTOMATION)
# ============================================
# OpenAI API key for GPT-4 and GPT-4o-mini
# Get from: OpenAI Platform → API Keys → Create new secret key
# Used for: WhatsApp AI, Phone AI, Email AI, Lead classification, Follow-ups
OPENAI_API_KEY=sk-your-openai-api-key

# ============================================
# TWILIO (PHONE AI)
# ============================================
# Twilio Account SID
# Get from: Twilio Console → Account Info → Account SID
TWILIO_ACCOUNT_SID=your-twilio-account-sid

# Twilio Auth Token
# Get from: Twilio Console → Account Info → Auth Token
TWILIO_AUTH_TOKEN=your-twilio-auth-token

# Twilio phone number (must be purchased from Twilio)
# Get from: Twilio Console → Phone Numbers → Manage → Active numbers
# Format: +1234567890 (E.164 format with country code)
TWILIO_PHONE_NUMBER=+1234567890

# ============================================
# WHATSAPP CLOUD API
# ============================================
# WhatsApp Business API token
# Get from: Meta for Developers → WhatsApp → API Setup → Temporary access token
# For production: Create permanent token via System User
WHATSAPP_API_TOKEN=your-whatsapp-api-token

# WhatsApp Phone Number ID (not the phone number itself)
# Get from: Meta for Developers → WhatsApp → API Setup → Phone number ID
WHATSAPP_PHONE_NUMBER_ID=your-phone-number-id

# WhatsApp webhook verify token (you create this, must match in Meta dashboard)
# Set in: Meta for Developers → WhatsApp → Configuration → Webhook → Verify token
WHATSAPP_VERIFY_TOKEN=your-custom-verify-token

# ============================================
# GOOGLE CALENDAR OAUTH
# ============================================
# Google OAuth Client ID
# Get from: Google Cloud Console → APIs & Services → Credentials → Create OAuth 2.0 Client ID
# Application type: Web application
# Authorized redirect URIs: https://your-domain.com/api/auth/google/callback
GOOGLE_CLIENT_ID=your-google-client-id

# Google OAuth Client Secret
# Get from: Google Cloud Console → APIs & Services → Credentials → Client secret
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Google OAuth redirect URI (must match authorized redirect URI in Google Console)
GOOGLE_REDIRECT_URI=https://your-domain.com/api/auth/google/callback

# ============================================
# EMAIL (IMAP/SMTP)
# ============================================
# Email address for inbox sync
EMAIL_USER=your-email@example.com

# Email password or app-specific password
# For Gmail: Use App Password (Google Account → Security → 2-Step Verification → App passwords)
EMAIL_PASSWORD=your-email-password

# IMAP server hostname
# Gmail: imap.gmail.com, Outlook: outlook.office365.com
EMAIL_IMAP_HOST=imap.gmail.com

# IMAP port (usually 993 for SSL)
EMAIL_IMAP_PORT=993

# SMTP server hostname
# Gmail: smtp.gmail.com, Outlook: smtp.office365.com
EMAIL_SMTP_HOST=smtp.gmail.com

# SMTP port (587 for TLS, 465 for SSL)
EMAIL_SMTP_PORT=587

# Use secure connection for SMTP (true for SSL, false for TLS)
EMAIL_SMTP_SECURE=false

# ============================================
# N8N WORKFLOW AUTOMATION
# ============================================
# n8n webhook base URL
# Get from: Your n8n instance → Workflows → Webhook node → Production URL
# Example: https://your-n8n-instance.com/webhook
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook

# ============================================
# SECURITY & ENCRYPTION
# ============================================
# Encryption key for sensitive data (64-character hex string)
# Generate with: openssl rand -hex 32
# Used for: Encrypting API keys, tokens, and sensitive user data
ENCRYPTION_KEY=your-64-character-hex-encryption-key-generate-with-openssl-rand-hex-32

# NextAuth secret for session encryption
# Generate with: openssl rand -base64 32
# Used for: Session token encryption and CSRF protection
NEXTAUTH_SECRET=your-nextauth-secret-generate-with-openssl-rand-base64-32

# ============================================
# RATE LIMITING (OPTIONAL)
# ============================================
# Upstash Redis URL for rate limiting
# Get from: Upstash Console → Create Database → REST API → UPSTASH_REDIS_REST_URL
# Optional: Leave empty to disable rate limiting (not recommended for production)
RATE_LIMIT_REDIS_URL=https://your-upstash-redis.upstash.io

# Upstash Redis token
# Get from: Upstash Console → Database → REST API → UPSTASH_REDIS_REST_TOKEN
RATE_LIMIT_REDIS_TOKEN=your-upstash-redis-token

# ============================================
# APPLICATION SETTINGS
# ============================================
# Public URL of your application
# Development: http://localhost:3000
# Production: https://your-domain.com
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Node environment (development, production, test)
NODE_ENV=development

# Log level (error, warn, info, debug)
# Use 'info' for production, 'debug' for development
LOG_LEVEL=info

# ============================================
# VERCEL DEPLOYMENT (PRODUCTION ONLY)
# ============================================
# These are automatically set by Vercel, no need to configure manually
# VERCEL=1
# VERCEL_ENV=production
# VERCEL_URL=your-deployment-url.vercel.app

# ============================================
# SETUP CHECKLIST
# ============================================
# [ ] Copy this file to .env.local
# [ ] Fill in all values above
# [ ] Run: yarn install
# [ ] Run: npx prisma generate
# [ ] Run: npx prisma migrate dev
# [ ] Run: npx ts-node scripts/create-stripe-products.ts
# [ ] Run: yarn dev
# [ ] Test signup → checkout → onboarding → dashboard flow
# [ ] Configure webhooks in Stripe, Twilio, WhatsApp dashboards
# [ ] Deploy to Vercel and set all environment variables there
