// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String   @id @default(cuid())
  email         String   @unique
  passwordHash  String
  firstName     String
  lastName      String
  phone         String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  studios       Studio[]
  subscriptions Subscription[]
}

model Studio {
  id           String   @id @default(cuid())
  name         String
  website      String?
  membersRange String
  phone        String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  owner        User   @relation(fields: [ownerId], references: [id])
  ownerId      String

  subscriptions Subscription[]
}

enum PlanTier {
  BASIC      // kleineres Studio / Einstieg
  GROWTH     // Standard / mittlere Größe
  ENTERPRISE // große Ketten
}

model Subscription {
  id                  String   @id @default(cuid())
  stripeCustomerId    String?
  stripeSubscriptionId String?
  stripePriceId       String?
  plan                PlanTier
  status              String   // z.B. active, trialing, canceled
  currentPeriodEnd    DateTime?

  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  user   User   @relation(fields: [userId], references: [id])
  userId String

  studio Studio @relation(fields: [studioId], references: [id])
  studioId String
}
